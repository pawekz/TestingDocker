type: Microsoft.App/containerApps
apiVersion: 2022-03-01
name: tooltrack-backend-app
location: southeastasia
properties:
  environmentId: /subscriptions/${{ secrets.AZURE_SUBSCRIPTION_ID }}/resourceGroups/testingdocker/providers/Microsoft.App/managedEnvironments/tooltrack-env-sea
  configuration:
    ingress:
      external: true
      targetPort: 8080
    registries:
      - server: ${{ secrets.AZURE_CONTAINER_REGISTRY }}
        username: ${{ secrets.REGISTRY_USERNAME }}
        passwordSecretRef: REGISTRY_PASSWORD
  template:
    containers:
      - name: backend
        image: ${{ secrets.AZURE_CONTAINER_REGISTRY }}/backend-tooltrack:${{ github.sha }}
        env:
          - name: DATABASE_URL
            value: ${{ secrets.DATABASE_URL }}